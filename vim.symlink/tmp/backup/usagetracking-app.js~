/* global dependencies */
var Marionette = require('backbone.marionette');
var AppChannel = require('advisor/app-channel');

/* module definition */
var UsageTracking = Marionette.Object.extend({
    initialize: function(options) {
        AppChannel.on('usage:pageview', this.trackPageview);
        AppChannel.on('usage:pageevent', this.sendPageEvent);
    },
    trackPageview: function() {
        if (window.ga) {
            // Update page in the tracker
            ga('set', 'page', '/' + AppChannel.request('currentRoute'));
            // Send page view to Google Analytics
            ga('send', 'pageview');
        }
    },
    sendPageEvent: function(category, action, label) {
        // Send custom events to Google Analytics
        // Google analytics event tracking accepts several parameters
        if (window.ga) {
            ga('send', 'event', category, action, label);
        }
    }
});

module.exports = UsageTracking;
