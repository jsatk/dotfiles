AdvisorApp.module('Entities', function(Entities, AdvisorApp) {
    var FacebookAdSet;
    var FacebookAdSets;
    var getFacebookAdSetEntity;
    var getFacebookAdSetEntities;
    var getFacebookPageableAdSetEntities;

    /**
     * Model and Collection definitions.
     */

    FacebookAdSet = Entities.Facebook.Base.Model.extend({
        urlRoot: '/api/facebook/ads/v1/adset/',
        /**
         * @returns {String} The current model's status.
         */
        getStatus: function() {
            return this.get('campaign_status').toLowerCase();
        }
    });

    FacebookAdSets = Entities.Facebook.Base.Collection.extend({
        url: FacebookAdSet.prototype.urlRoot,
        model: FacebookAdSet
    });

    /**
     * Get Entit(y/ies) methods
     */

    getFacebookAdSetEntity = function(adSetID) {
        return Entities.Facebook.Base.getBaseEntity(adSetID, FacebookAdSet);
    };

    getFacebookAdSetEntities = function(options) {
        return Entities.Facebook.Base.getBaseEntities(options, FacebookAdSets);
    };

    getFacebookPageableAdSetEntities = function(lineitem, userCanManage) {
        var statusChoices = [
            { label: 'Active',   value: 'ACTIVE'   },
            { label: 'Paused',   value: 'PAUSED'   },
            { label: 'Archived', value: 'ARCHIVED' }
        ];

        return Entities.Facebook.Base.getPageableBaseEntities(FacebookAdSet, lineitem, statusChoices, userCanManage);
    };

    /**
     * Handler Definitions
     */

    AdvisorApp.reqres.setHandler('facebook:adset:entity', function(adSetID) {
        return getFacebookAdSetEntity(adSetID);
    });

    AdvisorApp.reqres.setHandler('facebook:adset:entities', function(options) {
        return getFacebookAdSetEntities(options);
    });

    AdvisorApp.reqres.setHandler('facebook:adset:Entity', function() {
        return FacebookAdSet;
    });

    AdvisorApp.reqres.setHandler('facebook:adset:Entities', function() {
        return FacebookAdSets;
    });

    AdvisorApp.reqres.setHandler('facebook:adset:PageableEntities', function(lineitem, userCanManage) {
        return getFacebookPageableAdSetEntities(lineitem, userCanManage);
    });
});
