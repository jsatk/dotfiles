AdvisorApp.module('Common', function(Alert) {
    Alert.AlertView  = Marionette.ItemView.extend({
        template: Handlebars.templates.alert,
        ui: {
            'action_btn': '.action'
        },
        events: {
            'closed.bs.alert': 'destroy',
            'click @ui.action_btn': 'onActionClicked'
        },
        initialize: function() {
            debugger;
            this.render();
        },
        templateHelpers: function() {
            this.setTypeOnOptions();
            return this.options;
        },
        setTypeOnOptions: function() {
            var alertTypes = _.arrayToDictionary(['success', 'warning', 'danger']);
            var type       = this.model.get('type');

            type = alertTypes[type] ? type : 'info';
            // Would be cool to use Default object on this model instead but we
            // don't know what model will be passed in so we have to hack it instead.
            this.model.set('type', type);
        },
        onActionClicked:function(event) {
            var action = this.model.get('action');

            if (action.event) {
                event.preventDefault();
                AdvisorApp.trigger(action.event);
            } else {
                AdvisorApp.navigate(action.link);
            }

        }
    });
});
