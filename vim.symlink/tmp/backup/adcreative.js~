/* global dependencies */
var _ = require('underscore');

/* local dependencies */
var AdvisorCampaignEntity = require('../../advisor/campaign');
var CreativeEntity = require('../../creative');
var Values = require('./values');
var constraints = require('./constraints').constraints;

var AdCreative = CreativeEntity.SuperCreative.extend({
    defaults: {
        /** @type {string} */
        actor_id: undefined,
        actor_image_hash: undefined,
        actor_name: undefined,
        /** @type {string} body of the ad */
        body: undefined,
        /** @type {string} */
        call_to_action_type: undefined,
        filename: undefined,
        /** @type {boolean} */
        follow_redirect: undefined,
        id: undefined,
        /** @type {object} */
        image_crops: undefined,
        /** @type {string} */
        image_file: undefined,
        /** @type {string} */
        image_hash: undefined,
        /** @type {string} */
        image_url: undefined,
        link_deep_link_url: undefined,
        /** @type {string} */
        link_url: undefined,
        /** @type {string} */
        name: undefined,
        object_id: undefined,
        /** @type {string} */
        object_store_url: undefined,
        /** @type {string} */
        object_story_id: undefined,
        /** @type {object} */
        object_story_spec: undefined,
        object_type: undefined,
        /** @type {string} */
        object_url: undefined,
        preview_url: undefined,
        product_set_id: undefined,
        thumbnail_url: undefined,
        /** @type {string} */
        title: undefined,
        /** @type {string} */
        url_tags: undefined,
        video_id: undefined
    },
    /** @returns {string} */
    platform: _.constant('facebook'),
    /** @returns {string} */
    urlRoot: function() {
        var url = AdvisorCampaignEntity.Campaign.prototype.urlRoot;
        return url + this.get('campaignId') + '/fb_creative';
    },
    /**
    * @param {string} type -- view type
    * @returns {object}
    */
    getViewForKey: function(type) {
        return {
            'title': {
                text: 'Link headline',
                view: 'text',
                placeholder: 'Wowza!',
                optional: true,
                constraint: constraints('title')
            },
            'body': {
                text: 'Post text',
                view: 'textarea',
                placeholder: 'This post is great!',
                optional: true,
                constraint: constraints('body')
            },
            'message': {
                text: 'Post text',
                view: 'textarea',
                placeholder: 'This post is great!',
                optional: true,
                constraint: constraints('message')
            },
            'call_to_action': {
                text: 'Call to action',
                view: 'dropdown',
                values: Values.call_to_action,
                optional: true
            },
            'caption': {
                text: 'Display link',
                view: 'text',
                optional: true,
                constraint: constraints('caption')
            },
            'description': {
                text: 'Description',
                view: 'text',
                optional: true,
                constraint: constraints('description')
            },
            'image': {
                view: 'image',
                hideHeader: true
            },
            'video': {
                view: 'video',
                text: 'Video File'
            },
            'thumbnail': {
                view: 'image',
                text: 'Thumbnail'
            },
            'link_url': {
                text: 'Destination URL',
                view: 'text',
                placeholder: 'http://example.com'
            },
            'countries': {
                text: 'Countries',
                view: 'text',
                optional: true,
                suggestions: {
                    uri: '/api/advisor/v1/locationset/suggestions/',
                    params: {
                        platform: 'FACEBOOK',
                        type: 'locations',
                        location_types: 'country'
                    }
                }
            },
            'languages': {
                text: 'Languages',
                view: 'text',
                optional: true,
                suggestions: {
                    uri: '/api/advisor/v1/targetingsubset/suggestions/',
                    params: {
                        platform: 'FACEBOOK',
                        targeting_type: 'locales'
                    }
                }
            }
        }[type];
    }
}, {
     /**
     *  @param {string} type
     *  @returns {string}
     */
     getDefaultAdFormat: function(type) {
        switch (type) {
            case 'photo':
            case 'link':
            case 'video':
            case 'status': return 'DESKTOP_FEED_STANDARD';
            case 'non-page-post-link':
            case 'event':
            case 'fan': return 'RIGHT_COLUMN_STANDARD';
            default: throw new Error(type + ' does not have an ad_format');
        }
    }
 });

module.exports = AdCreative;
