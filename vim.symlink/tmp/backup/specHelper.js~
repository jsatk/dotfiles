/**
 * Need help creating helpers? Chai has a great guide here: http://chaijs.com/guide/helpers/
 */
chai.use(function(chai) {
    var Assertion = chai.Assertion;

    var instanceOfAssertions = [
        ['BackboneModel',                      Backbone.Model],
        ['BackboneView',                       Backbone.View],
        ['BackboneCollection',                 Backbone.Collection],
        ['BackboneRouter',                     Backbone.Router],
        [ 'BackboneTastypiePageableCollection', Backbone.TastypiePageableCollection],
        ['MarionetteApplication',              Marionette.Application],
        ['MarionetteAppRouter',                Marionette.AppRouter],
        ['MarionetteBehavior',                 Marionette.Behavior],
        ['MarionetteCollectionView',           Marionette.CollectionView],
        ['MarionetteCompositeView',            Marionette.CompositeView],
        ['MarionetteController',               Marionette.Controller],
        ['MarionetteItemView',                 Marionette.ItemView],
        ['MarionetteLayoutView',               Marionette.LayoutView],
        ['MarionetteObject',                   Marionette.Object],
        ['MarionetteRegionManager',            Marionette.RegionManager],
        ['MarionetteView',                     Marionette.View]
    ];

    _(instanceOfAssertions).each(function(assertion) {
        Assertion.addProperty(assertion[0], function() {
            this.assert(
                this._obj instanceof assertion[1],
                'expected #{this} to be a ' + assertion[0],     // Success message.
                'expected #{this} to not be a ' + assertion[0]  // Failure message.
            );
        });
    });

    // This soution came from here: http://stackoverflow.com/a/13075985/762889
    Assertion.addProperty('promise', function() {
        var assertion      = new Assertion(typeof this._obj.then).to.equal('function');
        var promiseThenSrc = String($.Deferred().then);
        var valueThenSrc   = String(this._obj.then);

        this.assert(
            promiseThenSrc === valueThenSrc,
            'expected #{this} to be a $.promise',       // Success message.
            'expected #{this} to not be a $.promise'    // Failure message.
        );
    });
});
